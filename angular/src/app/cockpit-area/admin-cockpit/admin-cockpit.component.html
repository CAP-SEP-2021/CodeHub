<form (ngSubmit)="getUserInput($event)" #filterForm>
  <div>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>{{ 'cockpit.createUser' | transloco }}</mat-panel-title>
      </mat-expansion-panel-header>

      <div class="formRow">
        <div class="formDesktopRow">
          <!-- username column -->
          <mat-form-field class="searchBy">
            <mat-label>{{ columns[0].label }}</mat-label>
            <input id="Username" matInput ngModel required="required" [formControl]="username"/>
          </mat-form-field>

          <!-- email column -->
          <mat-form-field class="searchBy" required="required">
            <mat-label>{{ columns[1].label }}</mat-label>
            <input id="Email" type="email" matInput ngModel [email]="true" required="required" [formControl]="email"/>
            <mat-error id="EmailError">
              Please enter a valid email address
            </mat-error>
          </mat-form-field>

          <!-- role column -->
          <mat-form-field class="searchBy">
            <mat-label>{{ columns[2].label }}</mat-label>
            <select matNativeControl id="Role">
              <option *ngFor="let role of roles" [value]="role.permission">
                {{role.label}}
              </option>
            </select>
          </mat-form-field>

          <!-- password column -->
          <mat-form-field class="searchBy">
            <mat-label>{{ columns[4].label }}</mat-label>
            <input required id="Password" matInput [type]="hide ? 'password' : 'text'" [formControl]="password"/>
            <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'"
              [attr.aria-pressed]="hide">
              <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </mat-form-field>

        </div>
      </div>

      <div class="align-right">
        <button mat-button type="button" color="warn" (click)="clearFilters(filterForm)">
          {{ 'buttons.reset' | transloco }}
        </button>
        <button id="submitButton" mat-button type="submit" color="accent">
          {{ 'buttons.create' | transloco }}
        </button>
      </div>

    </mat-expansion-panel>
  </div>
</form>

<mat-card>

  <mat-card-title>{{ 'cockpit.users.title' | transloco }}</mat-card-title>
  <mat-divider></mat-divider>

  <div class="tableContainer">

    <table mat-table [dataSource]="users">


      <!-- username column -->
      <ng-container matColumnDef="user.username">
        <th mat-header-cell *matHeaderCellDef>{{ columns[0].label }}</th>
        <td id="User" mat-cell *matCellDef="let element">{{ element.username }}</td>
      </ng-container>

      <!-- email column -->
      <ng-container matColumnDef="user.email">
        <th mat-header-cell *matHeaderCellDef>{{ columns[1].label }}</th>
        <td mat-cell *matCellDef="let element">{{ element.email }}</td>
      </ng-container>

      <!-- role column -->
      <ng-container matColumnDef="user.idRole">
        <th mat-header-cell *matHeaderCellDef>{{ columns[2].label }}</th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.userRoleId === 0"> {{ roles[0].label }}</span>
          <span *ngIf="element.userRoleId === 1"> {{ roles[1].label }}</span>
          <span *ngIf="element.userRoleId === 2"> {{ roles[2].label }}</span>
          <span *ngIf="element.userRoleId === 3"> {{ roles[3].label }}</span>
        </td>
      </ng-container>

      <!-- id column -->
      <ng-container matColumnDef="user.id">
        <th mat-header-cell *matHeaderCellDef class="lastColumn">{{ columns[3].label }}</th>
        <td mat-cell *matCellDef="let element" class="lastColumn">{{ element.id }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns" (click)="selected(row)"></tr>
    </table>
  </div>
  <mat-paginator #pagingBar [length]="totalUsers" [pageSize]="pageSize" [pageSizeOptions]="pageSizes"
    [showFirstLastButtons]="true" (page)="page($event)">
  </mat-paginator>

</mat-card>
